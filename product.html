<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sản phẩm — Store</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="page-products">
  <header>
    <div class="container header-row">
      <div class="logo"><a href="index.html">Nessa House</a></div>
      <nav>
        <ul>
          <li><a href="index.html">Trang chủ</a></li>
          <li><a href="products.html" style="color:var(--primary);border-bottom:2px solid var(--primary);padding-bottom:4px">Sản phẩm</a></li>
          <li><a href="login.html">Đăng nhập</a></li>
          <li><a href="register.html">Đăng ký</a></li>
        </ul>
      </nav>
      <div class="actions">
        <a class="icon-btn" href="cart.html" aria-label="Giỏ hàng">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M7 7h10l1.5 13H5.5L7 7Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M9 9V6a3 3 0 1 1 6 0v3" stroke="currentColor" stroke-width="1.6"/>
          </svg>
          <span id="cart-badge" class="badge">0</span>
        </a>
      </div>
    </div>
  </header>

  <!-- Page head -->
  <div class="container pagehead">
    <div class="crumbs"><a href="index.html">Home</a> / <b>Sản phẩm</b></div>
    <h1>Bộ sưu tập</h1>
  </div>

  <div class="container layout">
    <!-- Sidebar filters -->
    <aside>
      <p class="aside-title">Bộ lọc</p>

      <div class="field">
        <label class="label" for="q">Tìm kiếm</label>
        <input id="q" type="text" placeholder="Từ khóa (ví dụ: jeans, bag...)" />
      </div>

      <div class="field">
        <div class="label">Danh mục</div>
        <label class="check"><input type="checkbox" class="cat" value="jeans" checked> Jeans</label>
        <label class="check"><input type="checkbox" class="cat" value="accessories" checked> Accessories</label>
        <label class="check"><input type="checkbox" class="cat" value="makeup" checked> Make up</label>
      </div>

      <div class="field">
        <div class="label">Khoảng giá (k)</div>
        <div class="range">
          <input id="minp" type="number" min="0" step="50" placeholder="Min" />
          <input id="maxp" type="number" min="0" step="50" placeholder="Max" />
        </div>
        <div class="hint" style="font-size:12px;color:#9a8b8f;margin-top:6px">Ví dụ: 199 – 899</div>
      </div>

      <div class="field">
        <div class="label">Sắp xếp</div>
        <select id="sort">
          <option value="featured">Nổi bật</option>
          <option value="price-asc">Giá tăng dần</option>
          <option value="price-desc">Giá giảm dần</option>
          <option value="name-asc">Tên A → Z</option>
          <option value="name-desc">Tên Z → A</option>
        </select>
      </div>

      <div class="field" style="display:flex;gap:10px">
        <button id="apply" class="apply" type="button">Áp dụng</button>
        <button id="reset" class="apply reset" type="button">Reset</button>
      </div>
    </aside>

    <!-- Main content -->
    <section>
      <div class="toolbar">
        <div class="result"><span id="count">0</span> sản phẩm</div>
        <div class="sort">Sắp xếp nhanh:
          <select id="sort2">
            <option value="featured">Nổi bật</option>
            <option value="price-asc">Giá tăng dần</option>
            <option value="price-desc">Giá giảm dần</option>
            <option value="name-asc">Tên A → Z</option>
            <option value="name-desc">Tên Z → A</option>
          </select>
        </div>
      </div>

      <div id="grid" class="grid">
        <!-- Cards will be rendered by JS -->
      </div>

      <div class="pagination" id="pagination"></div>
    </section>
  </div>

  <div id="toast" class="toast">Đã thêm vào giỏ hàng</div>

  <script>
    // ------- Data (demo) -------
    const products = [
      {id:1, name:"Skinny Jeans Aurora", cat:"jeans", price:599, old:799, off:25, stock:12, rating:4.5},
      {id:2, name:"Classic Denim Blue", cat:"jeans", price:499, old:0, off:0, stock:6, rating:4.2},
      {id:3, name:"High-rise Mom Jeans", cat:"jeans", price:699, old:899, off:22, stock:9, rating:4.7},
      {id:4, name:"Minimal Tote Bag", cat:"accessories", price:329, old:0, off:0, stock:15, rating:4.0},
      {id:5, name:"Pearl Earrings Set", cat:"accessories", price:259, old:0, off:0, stock:20, rating:4.4},
      {id:6, name:"Silk Scarf Bloom", cat:"accessories", price:219, old:299, off:27, stock:7, rating:4.3},
      {id:7, name:"Matte Lipstick Rose", cat:"makeup", price:189, old:0, off:0, stock:33, rating:4.6},
      {id:8, name:"Nude Palette 9", cat:"makeup", price:349, old:429, off:19, stock:18, rating:4.5},
      {id:9, name:"Glow Highlighter", cat:"makeup", price:249, old:0, off:0, stock:11, rating:4.1},
      {id:10, name:"Straight Jeans Mist", cat:"jeans", price:549, old:0, off:0, stock:10, rating:4.0},
      {id:11, name:"Crossbody Mini", cat:"accessories", price:379, old:449, off:16, stock:8, rating:4.2},
      {id:12, name:"Velvet Lip Tint", cat:"makeup", price:199, old:0, off:0, stock:26, rating:4.4},
    ];

    // ------- State -------
    let cart = 0;
    let currentPage = 1;
    const perPage = 8;
    let activeSort = 'featured';

    // ------- Helpers -------
    const $ = (q, root=document) => root.querySelector(q);
    const $$ = (q, root=document) => [...root.querySelectorAll(q)];
    const fmtPrice = k => k.toLocaleString('vi-VN') + 'k';
    const stars = r => '★'.repeat(Math.round(r)) + '☆'.repeat(5-Math.round(r));

    function renderCards(list){
      const grid = $('#grid');
      grid.innerHTML = '';
      list.forEach(p=>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="thumb">
            ${p.off ? `<div class="off">-${p.off}%</div>` : ``}
          </div>
          <div class="card-body">
            <div class="title">${p.name}</div>
            <div class="price">
              <div class="now">${fmtPrice(p.price)}</div>
              ${p.old ? `<div class="old">${fmtPrice(p.old)}</div>`:''}
            </div>
            <div class="meta">
              <div class="stars" title="${p.rating}/5">${stars(p.rating)}</div>
              <div class="stock">Còn: ${p.stock}</div>
            </div>
            <div class="cta">
              <button class="btn-add" data-id="${p.id}">Add to cart</button>
            </div>
          </div>`;
        grid.appendChild(card);
      });

      // bind cart buttons
      $$('.btn-add').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          cart++; $('#cart-badge').textContent = cart;
          showToast('Đã thêm "' + products.find(x=>x.id==btn.dataset.id).name + '"');
        });
      });
      $('#count').textContent = list.length;
    }

    function paginate(arr, page=1, per=perPage){
      const start = (page-1)*per;
      return arr.slice(start, start+per);
    }

    function renderPagination(total, page=1, per=perPage){
      const pages = Math.max(1, Math.ceil(total/per));
      const el = $('#pagination');
      el.innerHTML = '';
      for(let i=1;i<=pages;i++){
        const b = document.createElement('button');
        b.className = 'page' + (i===page?' active':'');
        b.textContent = i;
        b.addEventListener('click', ()=>{
          currentPage = i;
          applyFilters();
        });
        el.appendChild(b);
      }
    }

    function getFilters(){
      const q = $('#q').value.trim().toLowerCase();
      const cats = $$('.cat').filter(c=>c.checked).map(c=>c.value);
      const minp = parseInt($('#minp').value || '0', 10);
      const maxp = parseInt($('#maxp').value || '999999', 10);
      return {q, cats, minp, maxp};
    }

    function sortList(list, key){
      switch(key){
        case 'price-asc': return list.slice().sort((a,b)=>a.price-b.price);
        case 'price-desc': return list.slice().sort((a,b)=>b.price-a.price);
        case 'name-asc': return list.slice().sort((a,b)=>a.name.localeCompare(b.name));
        case 'name-desc': return list.slice().sort((a,b)=>b.name.localeCompare(a.name));
        default: return list; // featured
      }
    }

    function applyFilters(){
      const {q, cats, minp, maxp} = getFilters();
      let list = products.filter(p =>
        (cats.includes(p.cat)) &&
        (p.name.toLowerCase().includes(q)) &&
        (p.price >= minp && p.price <= maxp)
      );
      list = sortList(list, activeSort);
      const pageList = paginate(list, currentPage, perPage);
      renderCards(pageList);
      renderPagination(list.length, currentPage, perPage);
    }

    function showToast(msg){
      const t = $('#toast');
      t.textContent = msg;
      t.classList.add('show');
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=>t.classList.remove('show'), 1600);
    }

    // ------- Events -------
    $('#apply').addEventListener('click', ()=>{ currentPage=1; activeSort=$('#sort').value; $('#sort2').value=activeSort; applyFilters(); });
    $('#reset').addEventListener('click', ()=>{
      $('#q').value=''; $$('.cat').forEach(c=>c.checked=true);
      $('#minp').value=''; $('#maxp').value='';
      $('#sort').value='featured'; $('#sort2').value='featured';
      currentPage=1; activeSort='featured'; applyFilters();
    });
    $('#sort2').addEventListener('change', e=>{ activeSort=e.target.value; currentPage=1; $('#sort').value=activeSort; applyFilters(); });
    $('#q').addEventListener('keydown', e=>{ if(e.key==='Enter'){ currentPage=1; applyFilters(); } });

    // ------- Init -------
    applyFilters();
  </script>
</body>
</html>
